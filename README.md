# 模擬試験結果閲覧システム 使用マニュアル

## 🌐 アクセス方法

**URL**: https://bob16165.github.io/mogisiken/index-supabase.html

---

# 📚 学生用マニュアル

## ログイン方法

1. **ブラウザでURLを開く**
2. **ID（学籍番号）を入力**
   - 例: `216030`、`226005` など
3. **パスワードを入力**
   - 初期パスワードは教員から通知されます
4. **「ログイン」ボタンをクリック**

## 成績の見方

### 📊 総合成績
- **総合点**: 全科目の合計得点
- **必修**: 必修問題の得点
- **一般合計**: 一般問題の合計
- **4教科合計**: 解剖学・生理学・一般臨床・柔整理論の合計

### 📈 科目別成績
各科目ごとに以下が表示されます：
- **得点**: あなたの点数 / 満点
- **得点率**: パーセンテージ（％）
- **順位**: クラス内での順位
- **偏差値**: 全体平均からの位置

### 🔍 問題詳細の確認
1. **科目名をクリック**すると、その科目の問題別詳細が表示されます
2. 各問題ごとに以下が確認できます：
   - あなたの解答
   - 正答（卒業判定試験では非表示）
   - 正誤（○×）
   - 正答率（何％の人が正解したか）
   - 出典（教科書のページなど）

### 📚 苦手領域の確認
画面下部に「苦手領域分析」が表示されます：
- **これまでの全試験で間違えた問題の出典**を集計
- **間違いが多い項目**から優先的に復習しましょう
- 科目ごとに整理されています

### 📝 複数の試験を確認する
1. **画面上部の「試験選択」ドロップダウン**をクリック
2. 見たい試験を選択
3. 成績が切り替わります

---

# 👨‍🏫 教員用マニュアル

## 初回セットアップ

### 1. 教員アカウントでログイン
- **ID**: `admin` または `teacher001`
- **パスワード**: 管理者から通知されたパスワード

### 2. 学生マスター（氏名・パスワード）の登録

#### CSVファイルの準備
Excelで以下の形式で作成し、CSV形式で保存：

```csv
学籍番号,氏名,パスワード
216030,山田太郎,2024
216062,佐藤花子,2024
226005,鈴木一郎,2024
```

- **1行目**: ヘッダー（そのまま）
- **2行目以降**: 学籍番号、氏名、パスワード
- **パスワード省略時**: 自動で「1234」が設定されます

#### アップロード手順
1. **ログイン後、右上の「CSVアップロード」ボタン**をクリック
2. **「学生氏名マスター 登録/更新」ボタン**をクリック
3. **登録方法を選択**:
   - **追加登録**: 既存データに追加（通常はこちら）
   - **上書き登録**: 全データを削除して新規登録（年度更新時）
4. **CSVファイルを選択**
5. **「追加登録」または「上書き登録」ボタン**をクリック
6. 完了メッセージが表示されたら成功

## 試験データのアップロード

### 必要なCSVファイル

#### 1. 前半データ（Q1～Q128）
- **形式**: `学籍番号, Q1の解答, Q2の解答, ..., Q128の解答`
- **科目構成**:
  - Q1～Q50: 必修
  - Q51～Q80: 解剖学
  - Q81～Q105: 生理学
  - Q106～Q115: 運動学
  - Q116～Q128: 病理学

#### 2. 後半データ（Q1～Q122）
- **形式**: `学籍番号, Q1の解答, Q2の解答, ..., Q122の解答`
- **科目構成**:
  - Q1～Q12: 衛生学
  - Q13～Q23: リハビリ医学
  - Q24～Q45: 一般臨床
  - Q46～Q56: 外科学
  - Q57～Q67: 整形外科
  - Q68～Q122: 柔整理論

#### 3. 模範解答データ（任意）
横形式で以下のように作成：

```csv
模範解答前半,Q1,Q2,Q3,...,Q128,模範解答後半,Q1,Q2,...,Q122
,3,1,4,...,2,,2,3,...,1
```

#### 4. 出題基準データ（任意）
横形式で以下のように作成：

```csv
出題基準前半,Q1,Q2,Q3,...,Q128,出題基準後半,Q1,Q2,...,Q122
,1,1,3,...,2,,1,2,...,1
```

- 番号は教科書の項目番号など

#### 5. 出典マッピングファイル（任意）
番号を項目名に変換するファイル：

```csv
科目名,番号,項目名
解剖学,1,骨格系
解剖学,2,筋系
生理学,1,細胞の構造
```

または全科目共通の場合：

```csv
番号,項目名
1,骨格系
2,筋系
```

### アップロード手順

1. **「CSVアップロード」ボタン**をクリック
2. **試験名を入力**（例: 第5回模試、2024年12月模試）
3. **各CSVファイルを選択**:
   - 前半データ（必須 or 任意）
   - 後半データ（必須 or 任意）
   - 模範解答データ（任意）
   - 出題基準データ（任意）
   - 出典マッピングファイル（任意）
4. **卒業判定試験の場合**: 「卒業判定試験」にチェック
   - 学生に正答・結果・正答率・出典が非表示になります
5. **「データをアップロード」ボタン**をクリック

### 📝 部分更新（前半のみ・後半のみ）

すでに登録済みの試験に対して、前半または後半のみを更新できます：

1. **同じ試験名を入力**
2. **更新したい方のCSVのみを選択**:
   - 前半のみ更新: 前半データのみ選択
   - 後半のみ更新: 後半データのみ選択
3. **「データをアップロード」**をクリック
4. 確認ダイアログで「OK」を選択

既存データと新しいデータが自動的にマージされます。

## 成績閲覧

### 全学生一覧
1. **ログイン後、自動で「個別詳細」画面**が表示されます
2. **「全学生一覧」ボタン**をクリック
3. 総合点順に全学生の成績が表示されます
4. **「詳細」ボタン**で個別学生の詳細を確認

### 個別学生の詳細
1. **「個別詳細」ボタン**をクリック
2. **学生選択ドロップダウン**から学生を選択
3. その学生の詳細成績が表示されます

### 試験の切り替え
1. **画面上部の試験選択ドロップダウン**から試験を選択
2. 成績が切り替わります

## 試験データの削除

### 方法1: アップロード画面から
1. **「CSVアップロード」ボタン**をクリック
2. **登録済み試験データ**の一覧から削除したい試験の「削除」ボタンをクリック
3. 確認ダイアログで「OK」

### 方法2: 成績閲覧画面から
1. **削除したい試験を選択**
2. **「🗑️ 削除」ボタン**をクリック（試験選択の隣）
3. 確認ダイアログで「OK」

---

# ❓ よくある質問（FAQ）

## 学生向け

**Q. パスワードを忘れました**
- A. 教員に問い合わせてください

**Q. ログインできません**
- A. 学籍番号とパスワードが正しいか確認してください
- A. 教員がまだ学生マスターを登録していない可能性があります

**Q. 試験が表示されません**
- A. 教員がまだ試験データをアップロードしていない可能性があります

**Q. 苦手領域が表示されません**
- A. 正答データがアップロードされていない試験は表示されません
- A. 全問正解の場合も「間違えた問題はありません」と表示されます

## 教員向け

**Q. CSVファイルのエンコーディングは？**
- A. UTF-8またはShift-JIS（自動判定）

**Q. 複数選択問題の入力方法は？**
- A. カンマ区切りで入力（例: `1,3`）
- A. Excelで入力すると時刻形式（1:03）に変換されますが、自動で認識されます

**Q. 学生の氏名を変更したい**
- A. 学生マスターCSVを修正して「追加登録」でアップロード（上書きされます）

**Q. 試験データを修正したい**
- A. 同じ試験名でCSVを再アップロード→「上書き」を選択

**Q. データはどこに保存される？**
- A. Supabaseクラウドデータベースに保存されます
- A. ブラウザのlocalStorageは使用していません

**Q. データ容量の上限は？**
- A. Supabase無料プランで500MBまで
- A. 通常の使用では十分な容量です

**Q. データのバックアップは？**
- A. Supabaseが自動バックアップ
- A. CSVファイルを保管しておけば再アップロード可能

---

# 🔐 セキュリティについて

- パスワードはSHA-256でハッシュ化されて保存されます
- 教員アカウントは管理者が管理してください
- URLは関係者のみに共有してください

---

# 📞 サポート

技術的な問題が発生した場合は、システム管理者に連絡してください。
